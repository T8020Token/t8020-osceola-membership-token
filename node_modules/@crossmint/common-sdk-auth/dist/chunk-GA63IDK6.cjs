"use strict";Object.defineProperty(exports, "__esModule", {value: true});var _chunkGMVKBAFQcjs = require('./chunk-GMVKBAFQ.cjs');var _chunkLTBCZHYJcjs = require('./chunk-LTBCZHYJ.cjs');var _chunk6R7OYJL5cjs = require('./chunk-6R7OYJL5.cjs');var _commonsdkbase = require('@crossmint/common-sdk-base');var l=class n{constructor(t,e,r={}){var a;this.crossmint=t,this.apiClient=e,this.refreshRoute=(a=r.refreshRoute)!=null?a:null}static from(t,e={}){return new n(t,n.defaultApiClient(t),e)}getJwksUri(){return`${this.apiClient.baseUrl}/.well-known/jwks.json`}refreshAuthMaterial(t){return _chunk6R7OYJL5cjs.a.call(void 0, this,null,function*(){if(this.refreshRoute!=null)return yield this.refreshFromCustomRoute(t);if(t!=null)return yield this.refresh(t);throw new (0, _chunkGMVKBAFQcjs.a)("Refresh token missing from parameters")})}refresh(t){return _chunk6R7OYJL5cjs.a.call(void 0, this,null,function*(){let e=yield this.apiClient.post(`${_chunkLTBCZHYJcjs.d}/refresh`,{body:JSON.stringify({refresh:t}),headers:{"Content-Type":"application/json"}});if(!e.ok)throw new (0, _chunkGMVKBAFQcjs.a)(e.statusText);let r=yield e.json();return{jwt:r.jwt,refreshToken:r.refresh,user:r.user}})}refreshFromCustomRoute(t){return _chunk6R7OYJL5cjs.a.call(void 0, this,null,function*(){if(this.refreshRoute==null)throw new Error("Custom refresh route is not set");let e=yield fetch(this.refreshRoute,{method:"POST",body:JSON.stringify({refresh:t}),headers:{"Content-Type":"application/json"}}),r=yield e.json();if(!e.ok)throw new (0, _chunkGMVKBAFQcjs.a)(r.message);return r})}logoutFromDefaultRoute(t){return _chunk6R7OYJL5cjs.a.call(void 0, this,null,function*(){return yield this.apiClient.post(`${_chunkLTBCZHYJcjs.d}/logout`,{headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh:t})})})}static defaultApiClient(t){return new (0, _commonsdkbase.CrossmintApiClient)(t,{internalConfig:{sdkMetadata:{name:_chunkLTBCZHYJcjs.b,version:_chunkLTBCZHYJcjs.a}}})}};exports.a = l;
