import{a as i}from"./chunk-NQMKBUHU.js";import{a as h,b as u,d as o}from"./chunk-KQ4HJI3P.js";import{a as s}from"./chunk-DUTPQ56Q.js";import{CrossmintApiClient as p}from"@crossmint/common-sdk-base";var l=class n{constructor(t,e,r={}){var a;this.crossmint=t,this.apiClient=e,this.refreshRoute=(a=r.refreshRoute)!=null?a:null}static from(t,e={}){return new n(t,n.defaultApiClient(t),e)}getJwksUri(){return`${this.apiClient.baseUrl}/.well-known/jwks.json`}refreshAuthMaterial(t){return s(this,null,function*(){if(this.refreshRoute!=null)return yield this.refreshFromCustomRoute(t);if(t!=null)return yield this.refresh(t);throw new i("Refresh token missing from parameters")})}refresh(t){return s(this,null,function*(){let e=yield this.apiClient.post(`${o}/refresh`,{body:JSON.stringify({refresh:t}),headers:{"Content-Type":"application/json"}});if(!e.ok)throw new i(e.statusText);let r=yield e.json();return{jwt:r.jwt,refreshToken:r.refresh,user:r.user}})}refreshFromCustomRoute(t){return s(this,null,function*(){if(this.refreshRoute==null)throw new Error("Custom refresh route is not set");let e=yield fetch(this.refreshRoute,{method:"POST",body:JSON.stringify({refresh:t}),headers:{"Content-Type":"application/json"}}),r=yield e.json();if(!e.ok)throw new i(r.message);return r})}logoutFromDefaultRoute(t){return s(this,null,function*(){return yield this.apiClient.post(`${o}/logout`,{headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh:t})})})}static defaultApiClient(t){return new p(t,{internalConfig:{sdkMetadata:{name:u,version:h}}})}};export{l as a};
