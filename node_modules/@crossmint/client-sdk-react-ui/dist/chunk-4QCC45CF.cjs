"use strict";Object.defineProperty(exports, "__esModule", {value: true});var _chunkPC74ALETcjs = require('./chunk-PC74ALET.cjs');var _chunkVNEMKR3Qcjs = require('./chunk-VNEMKR3Q.cjs');var _chunkQVM6WPJUcjs = require('./chunk-QVM6WPJU.cjs');var _chunk2WSEHVNPcjs = require('./chunk-2WSEHVNP.cjs');var _react = require('react');var _clientsdkreactbase = require('@crossmint/client-sdk-react-base');var _jsxruntime = require('react/jsx-runtime');var p=P=>()=>{throw new Error(`${P} is not available. Make sure you're using an email or phone signer wallet.`)};function x({children:P,showPasskeyHelpers:d=!0,appearance:m,createOnLogin:o,callbacks:i}){let{experimental_customAuth:t}=_clientsdkreactbase.useCrossmint.call(void 0, ),[W,c]=_react.useState.call(void 0, {open:!1}),[D,y]=_react.useState.call(void 0, !1),[F,N]=_react.useState.call(void 0, "initial"),[j,f]=_react.useState.call(void 0, !1),[q,V]=_react.useState.call(void 0, "initial"),A=_react.useRef.call(void 0, !1),S=_react.useRef.call(void 0, p("sendEmailWithOtp")),u=_react.useRef.call(void 0, p("verifyOtp")),v=_react.useRef.call(void 0, p("sendPhoneWithOtp")),g=_react.useRef.call(void 0, p("verifyPhoneOtp")),n=_react.useRef.call(void 0, p("reject")),C=(o==null?void 0:o.signer.type)==="phone"&&(o==null?void 0:o.signer.phone)!=null?o.signer.phone:t==null?void 0:t.phone,T=_react.useCallback.call(void 0, e=>()=>new Promise(r=>{if(!d){r();return}c({type:e,open:!0,primaryActionOnClick:()=>{c({open:!1}),r()},secondaryActionOnClick:()=>{c({open:!1}),r()}})}),[d]),R=()=>_chunk2WSEHVNPcjs.d.call(void 0, this,null,function*(){try{yield S.current(),N("otp")}catch(e){console.error("Failed to send email OTP",e),n.current(new Error("Failed to send email OTP"))}}),B=e=>_chunk2WSEHVNPcjs.d.call(void 0, this,null,function*(){try{yield u.current(e),y(!1)}catch(r){console.error("Failed to verify OTP",r),n.current(new Error("Failed to verify OTP"))}}),w=()=>_chunk2WSEHVNPcjs.d.call(void 0, this,null,function*(){try{yield v.current(),V("otp")}catch(e){console.error("Failed to send phone OTP",e),n.current(new Error("Failed to send phone OTP"))}}),I=e=>_chunk2WSEHVNPcjs.d.call(void 0, this,null,function*(){try{yield g.current(e),f(!1)}catch(r){console.error("Failed to verify phone OTP",r),n.current(new Error("Failed to verify phone OTP"))}});return _jsxruntime.jsxs.call(void 0, _clientsdkreactbase.CrossmintWalletBaseProvider,{createOnLogin:o,onAuthRequired:(e,r,O,U)=>_chunk2WSEHVNPcjs.d.call(void 0, this,null,function*(){(o==null?void 0:o.signer.type)==="phone"&&o.signer.phone?(f(e),v.current=r,g.current=O):(y(e),S.current=r,u.current=O),A.current=e,n.current=U}),callbacks:(()=>{let e=i==null?void 0:i.onWalletCreationStart,r=i==null?void 0:i.onTransactionStart;return(o==null?void 0:o.signer.type)==="passkey"&&d&&(e=T("create-wallet"),r=T("transaction")),{onWalletCreationStart:e,onTransactionStart:r}})(),children:[P,_jsxruntime.jsx.call(void 0, _chunkPC74ALETcjs.a,{rejectRef:n,email:t==null?void 0:t.email,open:D&&(t==null?void 0:t.email)!=null,setOpen:y,step:F,onSubmitOTP:B,onResendOTPCode:R,onSubmitEmail:R,appearance:m}),_jsxruntime.jsx.call(void 0, _chunkVNEMKR3Qcjs.a,{rejectRef:n,phone:C,open:j&&C!=null,setOpen:f,step:q,onSubmitOTP:I,onResendOTPCode:w,onSubmitPhone:w,appearance:m}),_jsxruntime.jsx.call(void 0, _chunkQVM6WPJUcjs.a,{state:W,appearance:m})]})}exports.a = x;
