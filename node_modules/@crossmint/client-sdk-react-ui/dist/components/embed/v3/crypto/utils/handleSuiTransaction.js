import{d as s}from"../../../../../chunk-PXDN3KFO.js";import{isSuiWallet as l}from"@dynamic-labs/sui";import{Transaction as c}from"@mysten/sui/transactions";function u(T){return s(this,arguments,function*({primaryWallet:r,serializedTransaction:i,iframeClient:t}){let n;try{if(!l(r))throw new Error("primaryWallet is not a Sui wallet");if(n=yield r.getWalletClient(),!n)throw new Error("Failed to get wallet client")}catch(e){console.error("[CryptoWalletConnectionHandler] failed to get wallet client",e),t.send("crypto:send-transaction:failed",{error:"Failed to get wallet client"});return}let a;try{a=c.from(i)}catch(e){console.error("[CryptoWalletConnectionHandler] failed to send transaction",e),t.send("crypto:send-transaction:failed",{error:"Failed to deserialize transaction"});return}let o;try{o=yield r.signTransaction(a)}catch(e){console.error("[CryptoWalletConnectionHandler] failed to sign transaction",e),t.send("crypto:send-transaction:failed",{error:e.message});return}try{let e=yield n.executeTransactionBlock({transactionBlock:o.bytes,signature:o.signature});console.log("[CryptoWalletConnectionHandler] executeTransactionBlockResponse",e),t.send("crypto:send-transaction:success",{txId:e.digest})}catch(e){console.error("[CryptoWalletConnectionHandler] failed to send transaction",e),t.send("crypto:send-transaction:failed",{error:e.message});return}})}export{u as handleSuiTransaction};
