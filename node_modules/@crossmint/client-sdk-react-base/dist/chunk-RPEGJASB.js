import{createContext as w,useCallback as l,useMemo as _,useRef as h,useState as v}from"react";import{createCrossmint as j}from"@crossmint/common-sdk-base";import A from"lodash.isequal";import{jsx as R}from"react/jsx-runtime";var y=w(null);function a({children:c,apiKey:m,appId:C,extensionId:f,overrideBaseUrl:x}){let[d,o]=v(0),e=h(null);e.current==null&&(e.current=new Proxy(j({apiKey:m,overrideBaseUrl:x,appId:C,extensionId:f}),{set(t,r,n){return r==="jwt"&&t.jwt!==n&&o(i=>i+1),r==="experimental_customAuth"&&t.experimental_customAuth!==n&&o(i=>i+1),Reflect.set(t,r,n)}}));let s=l(t=>{if(e.current==null)throw new Error("CrossmintProvider is not initialized");t!==e.current.jwt&&(e.current.jwt=t,e.current.experimental_customAuth==null?e.current.experimental_customAuth={jwt:t}:e.current.experimental_customAuth.jwt=t)},[]),u=l(t=>{if(e.current==null)throw new Error("CrossmintProvider is not initialized");e.current.jwt!=(t==null?void 0:t.jwt)&&(e.current.jwt=t==null?void 0:t.jwt),A(t,e.current.experimental_customAuth)||(e.current.experimental_customAuth=t)},[]),p=_(()=>{if(!e.current)throw new Error("CrossmintProvider is not initialized");return{get crossmint(){return e.current},experimental_setCustomAuth:u,experimental_customAuth:e.current.experimental_customAuth,setJwt:s}},[u,s,d]);return R(y.Provider,{value:p,children:c})}export{y as a,a as b};
